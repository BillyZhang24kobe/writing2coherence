def format_test_prompt(context, sentence):
    return """You are about to perform the task of coherence detection for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to output 1 if S is coherent with C based on the following instructions; otherwise, output 0. You should output 1 only if: \na) sentence S semantically connects to context C, and \nb) all entities discussed in the new sentence S have been introduced in C, and \nc) the relation between sentence S and previous ones in C makes sense due to a missing discourse marker, and \nd) the new sentence S does not contradict or is inconsistent with previously presented information in C, and \ne) the new sentence S introduces information that is relevant to the context C established by the writer. \nC: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)

def format_test_prompt_gpt(context, sentence):
    return [
        {"role": "system", "content": """You are about to perform the task of coherence detection for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to output 1 if S is coherent with C based on the following instructions; otherwise, output 0. You should output 1 only if: \na) sentence S semantically connects to context C, and \nb) all entities discussed in the new sentence S have been introduced in C, and \nc) the relation between sentence S and previous ones in C makes sense due to a missing discourse marker, and \nd) the new sentence S does not contradict or is inconsistent with previously presented information in C, and \ne) the new sentence S introduces information that is relevant to the context C established by the writer. Now, please direclty generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_gpt_5shots_exp(context, sentence):
    return [
        {"role": "system", "content": """You are about to perform the task of coherence detection for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to output 1 if S is coherent with C; otherwise, output 0 and provide a concise explanation. Please disregard any incoherences in context C. Specifically, output 0 if: \na) the sentence S does not connect semantically with the context C; or \nb) the new sentence S discusses an entity that has not been introduced in C yet, or the new sentence discusses an entity that is ambiguous in C; or \nc) the relation between sentence S and previous ones in C doesn't make sense due to an inaccurate discourse marker; or \nd) sentence S contradicts or is inconsistent with previously presented information in C; or \ne) sentence S introduces information that is completely irrelevant to the context C; or \nf) sentence S introduces information that is either tangential or slightly irrelevant to the context C; or \ng) the comment of the sentence does not agree with the topic of the sentence itself, or some terms in S are not semantically consistent with each other.\n\nHere are some examples:\nC: I believe that young people nowadays do not give enough time to helping their communities.\nS: This, i believe is caused by the environment we live in. \nAnswer: 1\n\nC: Then, I wanna indicate that young people can study many things that are interesting or exciting things for young people.\nS: About students, they can learn various fields that students want to study.\nAnswer: 0\nConcise explanation: "students" does not connect semantically with "young people" in the context.\n\nC: There are three main reasons that my ideas support effectively, like action, study and knowledge.\nS: First of all, I wanna introduce young people's active points in comparison with older people.\nAnswer: 0\nConcise explanation: "active points" and the "action" mentioned in the intro are inconsistent.\n\nC: These publicity agents use a lot of techniques to make the products look better, for example they use specialized software like photoshop to increase the size of the product or make it brighter, or maybe an artificial imitation of the product that does not necessarily have the same texture of look.\nS: Even though one can observe this situation mostly in food products.\nAnswer: 0\nConcise explanation: This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC: I, however, think in terms of physical and mental factors young people are superior to older people.\nS: For example, in the case of sports young people can run and jump, and they can train their muscles that are used in each sport such as transitional sports or silence sports.\nAnswer: 0\nConcise explanation: "transitional sports" and "silence sports" does not agree with the topic of the sentence.\n\n  Now, please generate:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]


def format_test_prompt_gpt_10shots_exp(context, sentence):
    return [
        {"role": "system", "content": """You are about to perform the task of coherence detection for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to output 1 if S is coherent with C; otherwise, output 0 and provide a concise explanation. Please disregard any incoherences in context C. Specifically, output 0 if: \na) the sentence S does not connect semantically with the context C; or \nb) the new sentence S discusses an entity that has not been introduced in C yet, or the new sentence discusses an entity that is ambiguous in C; or \nc) the relation between sentence S and previous ones in C doesn't make sense due to an inaccurate discourse marker; or \nd) sentence S contradicts or is inconsistent with previously presented information in C; or \ne) sentence S introduces information that is completely irrelevant to the context C; or \nf) sentence S introduces information that is either tangential or slightly irrelevant to the context C; or \ng) the comment of the sentence does not agree with the topic of the sentence itself, or some terms in S are not semantically consistent with each other.\n\nHere are some examples:\nC: I believe that young people nowadays do not give enough time to helping their communities.\nS: This, i believe is caused by the environment we live in. \nAnswer: 1\n\nC: In general, many people think young people enjoy life more than older people do.\nS: I agree with this statement in terms of young men's advantages.\nAnswer: 1\n\nC: Then, I wanna indicate that young people can study many things that are interesting or exciting things for young people.\nS: About students, they can learn various fields that students want to study.\nAnswer: 0\nConcise explanation: "students" does not connect semantically with "young people" in the context.\n\nC: I believe that young people nowadays do not give enough time to helping their communities. This, i believe is caused by the environment we live in. However, this is not a problem that is only limited to the young developing generation. I think that the adults that are living right now are also guilty of this problem. It is our whole population that is causing this problem.\nS: In war times, we did not have enough food supplies, not enough houses, not enough water, not anything of any abundance then the surrounding fear and death.\nAnswer: 0\nConcise explanation: "war" is a new entity that has not been introduced yet. Adding "For example" to tie the sentence with the given context.\n\nC: There are three main reasons that my ideas support effectively, like action, study and knowledge.\nS: First of all, I wanna introduce young people's active points in comparison with older people.\nAnswer: 0\nConcise explanation: "active points" and the "action" mentioned in the intro are inconsistent.\n\nC: Cars are the most frequently used automobile in the world. Nowadays, everyone uses cars for their requirements, like going to the office,colleges and also some children for going to school also they preferthe car. It became part of life for the people.\nS: Since technology was growing day by day, in twenty years time may be people will stop using cars.\nAnswer: 0\nConcise explanation: In the previous sentence, it indicates that "cars became part of life for the people". Hence, sentence S is inconsistent with the previous statement.\n\nC: These publicity agents use a lot of techniques to make the products look better, for example they use specialized software like photoshop to increase the size of the product or make it brighter, or maybe an artificial imitation of the product that does not necessarily have the same texture of look.\nS: Even though one can observe this situation mostly in food products.\nAnswer: 0\nConcise explanation: This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC:  The best way to travel is in a group led by a tour guide. If we travel without a guide, we must pay a lot of money because we don't know how much it is. while travelling with a guide, we don't worry about that.\nS: Almost all of the tour guides are already contracted with restaurants, shopping malls and many places.\nAnswer: 0\nConcise explanation: This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC: I, however, think in terms of physical and mental factors young people are superior to older people.\nS: For example, in the case of sports young people can run and jump, and they can train their muscles that are used in each sport such as transitional sports or silence sports.\nAnswer: 0\nConcise explanation: "transitional sports" and "silence sports" are not semantically consistent with each other. They also do not agree with the topic of the sentence.\n\n  Now, please generate:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_gpt_16shots_exp(context, sentence):
    return [
        {"role": "system", "content": """You are about to perform the task of coherence detection for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to output 1 if S is coherent with C; otherwise, output 0 and provide a concise explanation. Please disregard any incoherences in context C. Specifically, output 0 if: \na) the sentence S does not connect semantically with the context C; or\nb) the new sentence S discusses an entity that has not been introduced in C yet, or the new sentence discusses an entity that is ambiguous in C; or\nc) the relation between sentence S and previous ones in C doesn't make sense due to an inaccurate discourse marker; or\nd) sentence S contradicts or is inconsistent with previously presented information in C; or\ne) sentence S introduces information that is completely irrelevant to the context C; or\nf) sentence S introduces information that is either tangential or slightly irrelevant to the context C; or\ng) the comment of the sentence does not agree with the topic of the sentence itself, or some terms in S are not semantically consistent with each other.\n\nHere are some examples:\nC: I believe that young people nowadays do not give enough time to helping their communities.\nS: This, i believe is caused by the environment we live in.\nAnswer: 1\n\nC: In general, many people think young people enjoy life more than older people do.\nS: I agree with this statement in terms of young men's advantages.\nAnswer: 1\n\nC: Cars are the most frequently used automobile in the world.\nS: Nowadays, everyone uses cars for their requirements, like going to the office, college and also some children for going to school also they prefer the car.\nAnswer: 1\n\nC: Then, I wanna indicate that young people can study many things that are interesting or exciting things for young people.\nS: About students, they can learn various fields that students want to study.\nAnswer: 0\nConcise explanation: "students" does not connect semantically with "young people" in the context.\n\nC: However, the war times have passed and there are fewer who remember or have lived through those conditions and the hardships of life. Now with some people having more money than they actually need there is no strong need to help each other out.\nS: Most of us also live in small apartments, where only the father, mother and the child rent.\nAnswer: 0\nConcise explanation: "us" in the sentence does not connect semantically with "people" in the context. Hence, "us" should be changed to "people".\n\nC: I believe that young people nowadays do not give enough time to helping their communities. This, i believe is caused by the environment we live in. However, this is not a problem that is only limited to the young developing generation. I think that the adults that are living right now are also guilty of this problem. It is our whole population that is causing this problem.\nS: In war times, we did not have enough food supplies, not enough houses, not enough water, not anything of any abundance then the surrounding fear and death.\nAnswer: 0\nConcise explanation: "war" is a new entity that has not been introduced yet. Adding "For example" to tie the sentence with the given context.\n\nC: Finally, I wanna state that young people can acquire many kinds of knowledge from older people.\nS: For example, it is part of a family relationship between grandfather or grandmother and children.\nAnswer: 0\nConcise explanation: "it" is ambiguous and does not connect semantically with the context.\n\nC: In my opinion it is definitely preferable to have a broad knowledge of several academic subjects to specializing in one single area.\nS: The most important aspect to me is the variety of topics which one specific subject can not supply.\nAnswer: 0\nConcise explanation: No connection between the aspect in sentence S and the previously established context in C.\n\nC: Since pollution content increased and started polluting the environment and surrounding people,plants ,animals etc. Because of this, they started using gases to operate the car. Many people use this type of car, so the pollution content has got reduced to some extent.\nS: Nowadays, petrol prices have also increased and people who make enough effort to keep using it.\nAnswer: 0\nConcise explanation: "it" in S is very ambiguous. It is unclear about what "it" refers to.\n\nC: Celerities bring many contributions to where they live. People visit the places where a famous celebrity was born.\nS: As a result of this touristic attraction the local economy will boost and bring new job opportunities to the community.\nConcise explanation: The birth place of a celebrity is rarely a "touristic attraction". Sentence S is inconsistent to context C.\n\nC: There are three main reasons that my ideas support effectively, like action, study and knowledge.\nS: First of all, I wanna introduce young people's active points in comparison with older people.\nAnswer: 0\nConcise explanation: "active points" and the "action" mentioned in the intro are inconsistant.\n\nC: Cars are the most frequently used automobile in the world. Nowadays, everyone uses cars for their requirements, like going to the office,colleges and also some children for going to school also they preferthe car. It became part of life for the people.\nS: Since technology was growing day by day, in twenty years time may be people will stop using cars.\nAnswer: 0\nConcise explanation: In the previous sentence, it indicates that "cars became part of life for the people". Hence, sentence S is inconsistent with the previous statement.\n\nC: These publicity agents use a lot of techniques to make the products look better, for example they use specialized software like photoshop to increase the size of the product or make it brighter, or maybe an artificial imitation of the product that does not necessarily have the same texture of look.\nS: Even though one can observe this situation mostly in food products.\nAnswer: 0\nConcise explanation: This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC:  The best way to travel is in a group led by a tour guide. If we travel without a guide, we must pay a lot of money because we don't know how much it is. while travelling with a guide, we don't worry about that.\nS: Almost all of the tour guides are already contracted with restaurants, shopping malls and many places.\nAnswer: 0\nConcise explanation: This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC: My advice is: if you are young and you can travel like a backpacker, do it, because when you are old and you can not walk long distances, I think it is better to pay a tour guide, because you do not have to worry about anything only you have to wake up early.\nS: You will remember more if you face some problems during your trip because you have to handle them.\nAnswer: 0\nConcise explanation: This sentence S is tangential and unnecessary.\n\nC: I, however, think in terms of physical and mental factors young people are superior to older people.\nS: For example, in the case of sports young people can run and jump, and they can train their muscles that are used in each sport such as transitional sports or silence sports.\nAnswer: 0\nConcise explanation: "transitional sports" and "silence sports" are not semantically consistent with each other. They also do not agree with the topic of the sentence.\n\nNow, please generate:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]


def format_test_prompt_cohesion(context, sentence):
    return """You are about to perform the task of cohesion detection for the sentences written by second-language English learners. In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S is incoherent with C because of a lack of cohesion based on the following instructions; otherwise, output 0. You should output 1 only if: \na) sentence S does not connect semantically with context C, or \nb) sentence S discusses an entity that has not been introduced in C yet, or sentence S discusses an entity that is ambiguous in C, or \nc) the relation between sentence S and previous ones in C doesn't make sense due to a missing discourse marker. \nC: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)

def format_test_prompt_cohesion_gpt(context, sentence):
    return [
        {"role": "system", "content": """In this task, given a sentence S that is incoherent with a context C, you need to detect the reason that causes the incoherence. There are seven possible reasons that can cause incoherences: \na) sentence S is incoherent with C because S does not connect semantically with C; \nb) sentence S is incoherent with C because S discusses an entity that has not been introduced in C yet, or the new sentence S discusses an entity that is ambiguous in C; \nc) sentence S is incoherent with C because the discourse relation between S and previous ones in C doesn't make sense due to an incorrect discourse marker; \nd) sentence S is incoherent with C because S contradicts or is inconsistent with previously presented information in C; \ne) sentence S is incoherent with C because S introduces information that is completely irrelevant to the context C; \nf) sentence S is incoherent with C because S introduces information that is tangential and unnecessary; \ng) sentence S is incoherent with C because the comment of the sentence does not agree with the topic of the sentence\n In this task, please think step by step and output 1 only if S is incoherent with C due to any of reason a), reason b) or reason c). Otherwise, output 0 if S is incoherent with C dur to other reasons. In your answer, start by direclty generating either 1 or 0 in the first line. Then, in a new line, follow with reasons. Now, please generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_cohesion_gpt_16shots_exp(context, sentence):
    return [
        {"role": "system", "content": """In this task, given a sentence S that is incoherent with a context C, you need to detect the reason that causes the incoherence. There are seven possible reasons that can cause incoherences: \na) sentence S is incoherent with C because S does not connect semantically with C; \nb) sentence S is incoherent with C because S discusses an entity that has not been introduced in C yet, or the new sentence S discusses an entity that is ambiguous in C; \nc) sentence S is incoherent with C because the discourse relation between S and previous ones in C doesn't make sense due to an incorrect discourse marker; \nd) sentence S is incoherent with C because S contradicts or is inconsistent with previously presented information in C; \ne) sentence S is incoherent with C because S introduces information that is completely irrelevant to the context C; \nf) sentence S is incoherent with C because S introduces information that is tangential and unnecessary; \ng) sentence S is incoherent with C because the comment of the sentence does not agree with the topic of the sentence\n In this task, please think step by step and output 1 only if S is incoherent with C due to any of reason a), reason b) or reason c). Otherwise, output 0 if S is incoherent with C dur to other reasons. In your answer, start by direclty generating either 1 or 0, then follow with reasons. \n\nHere are some examples:\nC: Then, I wanna indicate that young people can study many things that are interesting or exciting things for young people.\nS: About students, they can learn various fields that students want to study.\nAnswer: 1\nConcise explanation: "students" does not connect semantically with "young people" in the context.\n\nC: However, the war times have passed and there are fewer who remember or have lived through those conditions and the hardships of life. Now with some people having more money than they actually need there is no strong need to help each other out.\nS: Most of us also live in small apartments, where only the father, mother and the child rent.\nAnswer: 1\nConcise explanation: "us" in the sentence does not connect semantically with "people" in the context. Hence, "us" should be changed to "people".\n\nC: I believe that young people nowadays do not give enough time to helping their communities. This, i believe is caused by the environment we live in. However, this is not a problem that is only limited to the young developing generation. I think that the adults that are living right now are also guilty of this problem. It is our whole population that is causing this problem.\nS: In war times, we did not have enough food supplies, not enough houses, not enough water, not anything of any abundance then the surrounding fear and death.\nAnswer: 1\nConcise explanation: "war" is a new entity that has not been introduced yet. Adding "For example" to tie the sentence with the given context.\n\nC: Finally, I wanna state that young people can acquire many kinds of knowledge from older people.\nS: For example, it is part of a family relationship between grandfather or grandmother and children.\nAnswer: 1\nConcise explanation: "it" is ambiguous and does not connect semantically with the context.\n\nC: In my opinion it is definitely preferable to have a broad knowledge of several academic subjects to specializing in one single area.\nS: The most important aspect to me is the variety of topics which one specific subject can not supply.\nAnswer: 1\nConcise explanation: No connection between the aspect in sentence S and the previously established context in C.\n\nC: Since pollution content increased and started polluting the environment and surrounding people,plants ,animals etc. Because of this, they started using gases to operate the car. Many people use this type of car, so the pollution content has got reduced to some extent.\nS: Nowadays, petrol prices have also increased and people who make enough effort to keep using it.\nAnswer: 1\nConcise explanation: "it" in S is very ambiguous. It is unclear about what "it" refers to.\n\nC: If we travel without a guide, we may wander so many times because we don't have a lot of knowledge about where is an important place and what we have to see.\nS: So a guide can help us to travel around important places.\nAnswer: 1\nConcise explanation: "So" is not a discourse marker. It should be changed to "Therefore".\n\nC: Therefore, a guide can help us to travel around important places. Moreover, travelling in a group with a guide can reduce money waste.\nS: If we travel without a guide, we must pay a lot of money because we don't know how much it is.\nAnswer: 1\nConcise explanation: missing discourse marker "For example" that can ties S to C.\n\nC: Celerities bring many contributions to where they live. People visit the places where a famous celebrity was born.\nS: As a result of this touristic attraction the local economy will boost and bring new job opportunities to the community.\nAnswer: 0\nConcise explanation: The birth place of a celebrity is rarely a "touristic attraction". Sentence S is incoherent with context C because of inconsistency.\n\nC: There are three main reasons that my ideas support effectively, like action, study and knowledge.\nS: First of all, I wanna introduce young people's active points in comparison with older people.\nAnswer: 0\nConcise explanation: "active points" and the "action" mentioned in the intro are inconsistent.\n\nC: Cars are the most frequently used automobile in the world. Nowadays, everyone uses cars for their requirements, like going to the office,colleges and also some children for going to school also they preferthe car. It became part of life for the people.\nS: Since technology was growing day by day, in twenty years time may be people will stop using cars.\nAnswer: 0\nConcise explanation: In the previous sentence, it indicates that "cars became part of life for the people". Hence, sentence S is inconsistent with the previous statement.\n\nC: These publicity agents use a lot of techniques to make the products look better, for example they use specialized software like photoshop to increase the size of the product or make it brighter, or maybe an artificial imitation of the product that does not necessarily have the same texture of look.\nS: Even though one can observe this situation mostly in food products.\nAnswer: 0\nConcise explanation: This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC:  The best way to travel is in a group led by a tour guide. If we travel without a guide, we must pay a lot of money because we don't know how much it is. while travelling with a guide, we don't worry about that.\nS: Almost all of the tour guides are already contracted with restaurants, shopping malls and many places.\nAnswer: 0\nConcise explanation: This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC: My advice is: if you are young and you can travel like a backpacker, do it, because when you are old and you can not walk long distances, I think it is better to pay a tour guide, because you do not have to worry about anything only you have to wake up early.\nS: You will remember more if you face some problems during your trip because you have to handle them.\nAnswer: 0\nConcise explanation: This sentence S is tangential and unnecessary.\n\nC: I, however, think in terms of physical and mental factors young people are superior to older people.\nS: For example, in the case of sports young people can run and jump, and they can train their muscles that are used in each sport such as transitional sports or silence sports.\nAnswer: 0\nConcise explanation: "transitional sports" and "silence sports" are not consistent with each other. They also do not agree with the topic of the sentence.\n\nC: As there is a saying that try and try until you succeed and success is the stepping stone this is said because by trying new things only the man can prove himself to be the successful person he must also be confident of what he is doing.\nS: If we do the things as we know how to do, it will not cost anything that we cannot gain knowledge of by doing them.\nAnswer: 0\nConcise explanation: This sentence S is tangential and unnecessary.\n\nNow, please generate:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_cohesion_gpt_8shots_exp(context, sentence):
    return [
        {"role": "system", "content": """In this task, given a sentence S that is incoherent with a context C, you need to detect the reason that causes the incoherence. There are seven possible reasons that can cause incoherences: \na) sentence S is incoherent with C because S does not connect semantically with C; \nb) sentence S is incoherent with C because S discusses an entity that has not been introduced in C yet, or the new sentence S discusses an entity that is ambiguous in C; \nc) sentence S is incoherent with C because the discourse relation between S and previous ones in C doesn't make sense due to an incorrect discourse marker; \nd) sentence S is incoherent with C because S contradicts or is inconsistent with previously presented information in C; \ne) sentence S is incoherent with C because S introduces information that is completely irrelevant to the context C; \nf) sentence S is incoherent with C because S introduces information that is tangential and unnecessary; \ng) sentence S is incoherent with C because the comment of the sentence does not agree with the topic of the sentence\n In this task, please think step by step and output 1 only if S is incoherent with C due to any of reason a), reason b) or reason c). Otherwise, output 0 if S is incoherent with C dur to other reasons. In your answer, start by direclty generating either 1 or 0, then follow with reasons. \n\nHere are some examples:\nC: Then, I wanna indicate that young people can study many things that are interesting or exciting things for young people.\nS: About students, they can learn various fields that students want to study.\nAnswer: 1\nConcise explanation: "students" does not connect semantically with "young people" in the context.\n\nC: I believe that young people nowadays do not give enough time to helping their communities. This, i believe is caused by the environment we live in. However, this is not a problem that is only limited to the young developing generation. I think that the adults that are living right now are also guilty of this problem. It is our whole population that is causing this problem.\nS: In war times, we did not have enough food supplies, not enough houses, not enough water, not anything of any abundance then the surrounding fear and death.\nAnswer: 1\nConcise explanation: "war" is a new entity that has not been introduced yet. Adding "For example" to tie the sentence with the given context.\n\nC: In my opinion it is definitely preferable to have a broad knowledge of several academic subjects to specializing in one single area.\nS: The most important aspect to me is the variety of topics which one specific subject can not supply.\nAnswer: 1\nConcise explanation: No connection between the aspect in sentence S and the previously established context in C.\n\nC: Since pollution content increased and started polluting the environment and surrounding people,plants ,animals etc. Because of this, they started using gases to operate the car. Many people use this type of car, so the pollution content has got reduced to some extent.\nS: Nowadays, petrol prices have also increased and people who make enough effort to keep using it.\nAnswer: 1\nConcise explanation: "it" in S is very ambiguous. It is unclear about what "it" refers to.\n\nC: There are three main reasons that my ideas support effectively, like action, study and knowledge.\nS: First of all, I wanna introduce young people's active points in comparison with older people.\nAnswer: 0\nConcise explanation: "active points" and the "action" mentioned in the intro are inconsistent.\n\nC: Cars are the most frequently used automobile in the world. Nowadays, everyone uses cars for their requirements, like going to the office,colleges and also some children for going to school also they preferthe car. It became part of life for the people.\nS: Since technology was growing day by day, in twenty years time may be people will stop using cars.\nAnswer: 0\nConcise explanation: In the previous sentence, it indicates that "cars became part of life for the people". Hence, sentence S is inconsistent with the previous statement.\n\nC: These publicity agents use a lot of techniques to make the products look better, for example they use specialized software like photoshop to increase the size of the product or make it brighter, or maybe an artificial imitation of the product that does not necessarily have the same texture of look.\nS: Even though one can observe this situation mostly in food products.\nAnswer: 0\nConcise explanation: This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC: I, however, think in terms of physical and mental factors young people are superior to older people.\nS: For example, in the case of sports young people can run and jump, and they can train their muscles that are used in each sport such as transitional sports or silence sports.\nAnswer: 0\nConcise explanation: "transitional sports" and "silence sports" are not consistent with each other. They also do not agree with the topic of the sentence.\n\nNow, please generate:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_consistency(context, sentence):
    return """You are about to perform the task of consistency detection for the sentences written by second-language English learners. In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S contradicts previously presented information in C; otherwise, output 0. \nC: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)

def format_test_prompt_consistency_gpt(context, sentence):
    return [
        {"role": "system", "content": """You are about to perform the task of consistency detection for the sentences written by second-language English learners. In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S contradicts previously presented information in C; otherwise, output 0. Now, please generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_consistency_gpt_16shots_exp(context, sentence):
    return [
        {"role": "system", "content": """You are about to perform the task of consistency detection for the sentences written by second-language English learners. In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S contradicts previously presented information in C; otherwise, output 0. \n\nHere are some examples:\nC: Then, I wanna indicate that young people can study many things that are interesting or exciting things for young people.\nS: About students, they can learn various fields that students want to study.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. S is incoherent with C because "students" does not connect semantically with "young people" in the context.  \n\nC: However, the war times have passed and there are fewer who remember or have lived through those conditions and the hardships of life. Now with some people having more money than they actually need there is no strong need to help each other out.\nS: Most of us also live in small apartments, where only the father, mother and the child rent.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. S is incoherent with C because "us" in the sentence does not connect semantically with "people" in the context. Hence, "us" should be changed to "people". \n\nC: I believe that young people nowadays do not give enough time to helping their communities. This, i believe is caused by the environment we live in. However, this is not a problem that is only limited to the young developing generation. I think that the adults that are living right now are also guilty of this problem. It is our whole population that is causing this problem.\nS: In war times, we did not have enough food supplies, not enough houses, not enough water, not anything of any abundance then the surrounding fear and death.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. S is incoherent with C because "war" is a new entity that has not been introduced yet. Adding "For example" to tie the sentence with the given context.\n\n C: Finally, I wanna state that young people can acquire many kinds of knowledge from older people.\nS: For example, it is part of a family relationship between grandfather or grandmother and children.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. S is incoherent with C because "it" is ambiguous and does not connect semantically with the context.\n\nC: In my opinion it is definitely preferable to have a broad knowledge of several academic subjects to specializing in one single area.\nS: The most important aspect to me is the variety of topics which one specific subject can not supply.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. S is incoherent with C because there is no connection between the aspect in sentence S and the previously established context in C.\n\nC: Since pollution content increased and started polluting the environment and surrounding people,plants ,animals etc. Because of this, they started using gases to operate the car. Many people use this type of car, so the pollution content has got reduced to some extent.\nS: Nowadays, petrol prices have also increased and people who make enough effort to keep using it.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. S is incoherent with C because "it" in S is very ambiguous. It is unclear about what "it" refers to. \n\nC: If we travel without a guide, we may wander so many times because we don't have a lot of knowledge about where is an important place and what we have to see.\nS: So a guide can help us to travel around important places.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. S is incoherent with C because "So" is not a discourse marker. It should be changed to "Therefore".\n\nC: Therefore, a guide can help us to travel around important places. Moreover, travelling in a group with a guide can reduce money waste.\nS: If we travel without a guide, we must pay a lot of money because we don't know how much it is.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. S is incoherent with C because of the missing discourse marker "For example" that can tie S to C. \n\nC: Celerities bring many contributions to where they live. People visit the places where a famous celebrity was born.\nS: As a result of this touristic attraction the local economy will boost and bring new job opportunities to the community.\nAnswer: 1\nConcise explanation: Sentence S contradicts previously presented information in C. The birth place of a celebrity is rarely a "touristic attraction". Hence, "the birth place of a celebrity" contradicts "touristic attraction". Hence, Sentence S is incoherent with context C because of inconsistency.\n\nC: There are three main reasons that my ideas support effectively, like action, study and knowledge.\nS: First of all, I wanna introduce young people's active points in comparison with older people.\nAnswer: 1\nConcise explanation: Sentence S contradicts previously presented information in C. The "active points" and the "action" mentioned in the intro are inconsistent. Hence, Sentence S is incoherent with context C because of inconsistency. \n\nC: Cars are the most frequently used automobile in the world. Nowadays, everyone uses cars for their requirements, like going to the office,colleges and also some children for going to school also they preferthe car. It became part of life for the people.\nS: Since technology was growing day by day, in twenty years time may be people will stop using cars.\nAnswer: 1\nConcise explanation: Sentence S contradicts previously presented information in C.  In the previous sentence, it indicates that "cars became part of life for the people". Hence, sentence S is inconsistent with the previous statement. Sentence S is incoherent with context C because of inconsistency. \n\nC: These publicity agents use a lot of techniques to make the products look better, for example they use specialized software like photoshop to increase the size of the product or make it brighter, or maybe an artificial imitation of the product that does not necessarily have the same texture of look.\nS: Even though one can observe this situation mostly in food products.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC:  The best way to travel is in a group led by a tour guide. If we travel without a guide, we must pay a lot of money because we don't know how much it is. while travelling with a guide, we don't worry about that.\nS: Almost all of the tour guides are already contracted with restaurants, shopping malls and many places.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. This sentence is tangential and unnecessary. Hence, it should be deleted.\n\nC: My advice is: if you are young and you can travel like a backpacker, do it, because when you are old and you can not walk long distances, I think it is better to pay a tour guide, because you do not have to worry about anything only you have to wake up early.\nS: You will remember more if you face some problems during your trip because you have to handle them.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. This sentence S is tangential and unnecessary.\n\nC: I, however, think in terms of physical and mental factors young people are superior to older people.\nS: For example, in the case of sports young people can run and jump, and they can train their muscles that are used in each sport such as transitional sports or silence sports.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. "transitional sports" and "silence sports" are not consistent with each other in sentence S itself, and They also do not agree with the topic of the sentence. \n\nC: As there is a saying that try and try until you succeed and success is the stepping stone this is said because by trying new things only the man can prove himself to be the successful person he must also be confident of what he is doing.\nS: If we do the things as we know how to do, it will not cost anything that we cannot gain knowledge of by doing them.\nAnswer: 0\nConcise explanation: Sentence S does not contradict previously presented information in C. This sentence S is tangential and unnecessary.\n\nNow, please generate:Now, please generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_relevance(context, sentence):
    return """In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S is incoherent with C because of a lack of relevance based on the following instructions; otherwise, output 0. You should output 1 only if: \na) sentence S introduces information that is completely irrelevant to context C, or \nb) sentence S introduces information that is either tangential or slightly irrelevant to context C. \nC: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)

def format_test_prompt_relevance_gpt(context, sentence):
    return [
        {"role": "system", "content": """In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S is incoherent with C because of a lack of relevance based on the following instructions; otherwise, output 0. You should output 1 only if: \na) sentence S introduces information that is completely irrelevant to context C, or \nb) sentence S introduces information that is either tangential or slightly irrelevant to context C. Now, please generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_relevance_gpt_16shots_exp(context, sentence):
    return [
        {"role": "system", "content": """In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S is incoherent with C because of a lack of relevance based on the following instructions; otherwise, output 0. You should output 1 only if: \na) sentence S introduces information that is completely irrelevant to context C, or \nb) sentence S introduces information that is either tangential or slightly irrelevant to context C. \n\nHere are some examples:\nC: Then, I wanna indicate that young people can study many things that are interesting or exciting things for young people.\nS: About students, they can learn various fields that students want to study.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. S is incoherent with C because "students" does not connect semantically with "young people" in the context.\n\nC: However, the war times have passed and there are fewer who remember or have lived through those conditions and the hardships of life. Now with some people having more money than they actually need there is no strong need to help each other out.\nS: Most of us also live in small apartments, where only the father, mother and the child rent.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. S is incoherent with C because "us" in the sentence does not connect semantically with "people" in the context. Hence, "us" should be changed to "people". \n\nC: I believe that young people nowadays do not give enough time to helping their communities. This, i believe is caused by the environment we live in. However, this is not a problem that is only limited to the young developing generation. I think that the adults that are living right now are also guilty of this problem. It is our whole population that is causing this problem.\nS: In war times, we did not have enough food supplies, not enough houses, not enough water, not anything of any abundance then the surrounding fear and death.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. S is incoherent with C because "war" is a new entity that has not been introduced yet. Adding "For example" to tie the sentence with the given context.\n\nC: Finally, I wanna state that young people can acquire many kinds of knowledge from older people.\nS: For example, it is part of a family relationship between grandfather or grandmother and children.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. S is incoherent with C because "it" is ambiguous and does not connect semantically with the context.\n\nC: In my opinion it is definitely preferable to have a broad knowledge of several academic subjects to specializing in one single area.\nS: The most important aspect to me is the variety of topics which one specific subject can not supply.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. S is incoherent with C because there is no connection between the aspect in sentence S and the previously established context in C.\n\nC: Since pollution content increased and started polluting the environment and surrounding people,plants ,animals etc. Because of this, they started using gases to operate the car. Many people use this type of car, so the pollution content has got reduced to some extent.\nS: Nowadays, petrol prices have also increased and people who make enough effort to keep using it.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. S is incoherent with C because "it" in S is very ambiguous. It is unclear about what "it" refers to. \n\nC: If we travel without a guide, we may wander so many times because we don't have a lot of knowledge about where is an important place and what we have to see.\nS: So a guide can help us to travel around important places.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. S is incoherent with C because "So" is not a discourse marker. It should be changed to "Therefore". \n\nC: Therefore, a guide can help us to travel around important places. Moreover, travelling in a group with a guide can reduce money waste.\nS: If we travel without a guide, we must pay a lot of money because we don't know how much it is.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. S is incoherent with C because of the missing discourse marker "For example" that can tie S to C.\n\nC: Celerities bring many contributions to where they live. People visit the places where a famous celebrity was born.\nS: As a result of this touristic attraction the local economy will boost and bring new job opportunities to the community.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. The birth place of a celebrity is rarely a "touristic attraction". Hence, "the birth place of a celebrity" contradicts "touristic attraction". Hence, Sentence S is incoherent with context C because of inconsistency.\n\nC: There are three main reasons that my ideas support effectively, like action, study and knowledge.\nS: First of all, I wanna introduce young people's active points in comparison with older people.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. The "active points" and the "action" mentioned in the intro are inconsistent. Hence, Sentence S is incoherent with context C because of inconsistency. \n\nC: Cars are the most frequently used automobile in the world. Nowadays, everyone uses cars for their requirements, like going to the office,colleges and also some children for going to school also they preferthe car. It became part of life for the people.\nS: Since technology was growing day by day, in twenty years time may be people will stop using cars.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C.  In the previous sentence, it indicates that "cars became part of life for the people". Hence, sentence S is inconsistent with the previous statement. Sentence S is incoherent with context C because of inconsistency. \n\nC: These publicity agents use a lot of techniques to make the products look better, for example they use specialized software like photoshop to increase the size of the product or make it brighter, or maybe an artificial imitation of the product that does not necessarily have the same texture of look.\nS: Even though one can observe this situation mostly in food products.\nAnswer: 1\nConcise explanation: Sentence S introduces information that is irrelevant and tangential to context C. Since this sentence is tangential and unnecessary, it should be deleted. Sentence S is incoherent with context C because of the relevance issue. \n\nC:  The best way to travel is in a group led by a tour guide. If we travel without a guide, we must pay a lot of money because we don't know how much it is. while travelling with a guide, we don't worry about that.\nS: Almost all of the tour guides are already contracted with restaurants, shopping malls and many places.\nAnswer: 1\nConcise explanation: Sentence S introduces information that is irrelevant and tangential to context C. This sentence is tangential and unnecessary. Hence, it should be deleted. Sentence S is incoherent with context C because of the relevance issue.\n\nC: My advice is: if you are young and you can travel like a backpacker, do it, because when you are old and you can not walk long distances, I think it is better to pay a tour guide, because you do not have to worry about anything only you have to wake up early.\nS: You will remember more if you face some problems during your trip because you have to handle them.\nAnswer: 1\nConcise explanation: Sentence S introduces information that is irrelevant and tangential to context C. This sentence S is tangential and unnecessary. Sentence S is incoherent with context C because of the relevance issue. \n\nC: I, however, think in terms of physical and mental factors young people are superior to older people.\nS: For example, in the case of sports young people can run and jump, and they can train their muscles that are used in each sport such as transitional sports or silence sports.\nAnswer: 0\nConcise explanation: Sentence S introduces information that is relevant to context C. "transitional sports" and "silence sports" are not consistent with each other in sentence S itself, and They also do not agree with the topic of the sentence. \n\nC: As there is a saying that try and try until you succeed and success is the stepping stone this is said because by trying new things only the man can prove himself to be the successful person he must also be confident of what he is doing.\nS: If we do the things as we know how to do, it will not cost anything that we cannot gain knowledge of by doing them.\nAnswer: 1\nConcise explanation: Sentence S introduces information that is irrelevant and tangential to context C. This sentence S is tangential and unnecessary. Hence, Sentence S is incoherent with context C because of the relevance issue.  \n\nNow, please generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]


def format_test_prompt_other(context, sentence):
    return """In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S is incoherent with C because of the disagreement between the topic and the comment of sentence S; otherwise, output 0. Specifically, you should output 1 only if the comment of sentence S does not agree with the topic of the sentence itself. \nC: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)

def format_test_prompt_other_gpt(context, sentence):
    return [
        {"role": "system", "content": """In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S is incoherent with C because of the disagreement between the topic and the comment of sentence S; otherwise, output 0. Specifically, you should output 1 only if the comment of sentence S does not agree with the topic of the sentence itself. Now, please generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_other_gpt_16shots_exp(context, sentence):
    return [
        {"role": "system", "content": """In this task, given a sentence S that is incoherent with a context C, you need to output 1 if S is incoherent with C because of the disagreement between the topic and the comment of sentence S; otherwise, output 0. Specifically, you should output 1 only if the comment of sentence S does not agree with the topic of the sentence itself. \n\nHere are some examples:\nC: Then, I wanna indicate that young people can study many things that are interesting or exciting things for young people.\nS: About students, they can learn various fields that students want to study.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. S is incoherent with C because "students" does not connect semantically with "young people" in the context. \n\nC: However, the war times have passed and there are fewer who remember or have lived through those conditions and the hardships of life. Now with some people having more money than they actually need there is no strong need to help each other out.\nS: Most of us also live in small apartments, where only the father, mother and the child rent.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. S is incoherent with C because "us" in the sentence does not connect semantically with "people" in the context. Hence, "us" should be changed to "people". \n\nC: I believe that young people nowadays do not give enough time to helping their communities. This, i believe is caused by the environment we live in. However, this is not a problem that is only limited to the young developing generation. I think that the adults that are living right now are also guilty of this problem. It is our whole population that is causing this problem.\nS: In war times, we did not have enough food supplies, not enough houses, not enough water, not anything of any abundance then the surrounding fear and death.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. S is incoherent with C because "war" is a new entity that has not been introduced yet. Adding "For example" to tie the sentence with the given context. \n\nC: Finally, I wanna state that young people can acquire many kinds of knowledge from older people.\nS: For example, it is part of a family relationship between grandfather or grandmother and children.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. S is incoherent with C because "it" is ambiguous and does not connect semantically with the context.\n\nC: In my opinion it is definitely preferable to have a broad knowledge of several academic subjects to specializing in one single area.\nS: The most important aspect to me is the variety of topics which one specific subject can not supply.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. S is incoherent with C because there is no connection between the aspect in sentence S and the previously established context in C.\n\nC: Since pollution content increased and started polluting the environment and surrounding people,plants ,animals etc. Because of this, they started using gases to operate the car. Many people use this type of car, so the pollution content has got reduced to some extent.\nS: Nowadays, petrol prices have also increased and people who make enough effort to keep using it.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. S is incoherent with C because "it" in S is very ambiguous. It is unclear about what "it" refers to. \n\nC: If we travel without a guide, we may wander so many times because we don't have a lot of knowledge about where is an important place and what we have to see.\nS: So a guide can help us to travel around important places.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. S is incoherent with C because "So" is not a discourse marker. It should be changed to "Therefore". \n\nC: Therefore, a guide can help us to travel around important places. Moreover, travelling in a group with a guide can reduce money waste.\nS: If we travel without a guide, we must pay a lot of money because we don't know how much it is.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. S is incoherent with C because of the missing discourse marker "For example" that can tie S to C.\n\nC: Celerities bring many contributions to where they live. People visit the places where a famous celebrity was born.\nS: As a result of this touristic attraction the local economy will boost and bring new job opportunities to the community.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. The birth place of a celebrity is rarely a "touristic attraction". Hence, "the birth place of a celebrity" contradicts "touristic attraction". Hence, Sentence S is incoherent with context C because of inconsistency.\n\nC: There are three main reasons that my ideas support effectively, like action, study and knowledge.\nS: First of all, I wanna introduce young people's active points in comparison with older people.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. The "active points" and the "action" mentioned in the intro are inconsistent. Hence, Sentence S is incoherent with context C because of inconsistency. \n\nC: Cars are the most frequently used automobile in the world. Nowadays, everyone uses cars for their requirements, like going to the office,colleges and also some children for going to school also they preferthe car. It became part of life for the people.\nS: Since technology was growing day by day, in twenty years time may be people will stop using cars.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence.  In the previous sentence, it indicates that "cars became part of life for the people". Hence, sentence S is inconsistent with the previous statement. Sentence S is incoherent with context C because of inconsistency. \n\nC: These publicity agents use a lot of techniques to make the products look better, for example they use specialized software like photoshop to increase the size of the product or make it brighter, or maybe an artificial imitation of the product that does not necessarily have the same texture of look. \nS: Even though one can observe this situation mostly in food products.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. Since this sentence is tangential and unnecessary, it should be deleted. Sentence S is incoherent with context C because of the relevance issue. \n\nC:  The best way to travel is in a group led by a tour guide. If we travel without a guide, we must pay a lot of money because we don't know how much it is. while travelling with a guide, we don't worry about that.\nS: Almost all of the tour guides are already contracted with restaurants, shopping malls and many places. \nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. This sentence is tangential and unnecessary. Hence, it should be deleted. Sentence S is incoherent with context C because of the relevance issue. \n\nC: My advice is: if you are young and you can travel like a backpacker, do it, because when you are old and you can not walk long distances, I think it is better to pay a tour guide, because you do not have to worry about anything only you have to wake up early.\nS: You will remember more if you face some problems during your trip because you have to handle them.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. This sentence S is tangential and unnecessary. Sentence S is incoherent with context C because of the relevance issue. \n\nC: I, however, think in terms of physical and mental factors young people are superior to older people.\nS: For example, in the case of sports young people can run and jump, and they can train their muscles that are used in each sport such as transitional sports or silence sports.\nAnswer: 1\nConcise explanation: The comment of sentence S does not agree with the topic of the sentence. "transitional sports" and "silence sports" are not consistent with each other in sentence S itself, and they also do not agree with the topic of the sentence. Hence, Sentence S is incoherent with context C because of the disagreement between the topic and the comment of sentence S.\n\nC: As there is a saying that try and try until you succeed and success is the stepping stone this is said because by trying new things only the man can prove himself to be the successful person he must also be confident of what he is doing.\nS: If we do the things as we know how to do, it will not cost anything that we cannot gain knowledge of by doing them.\nAnswer: 0\nConcise explanation: The comment of sentence S agrees with the topic of the sentence. This sentence S is tangential and unnecessary. Hence, Sentence S is incoherent with context C because of the relevance issue. \n\nNow, please generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]

def format_test_prompt_rewriting_nr(context, sentence):
    return """You are about to perform the task of sentence rewriting for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to rewrite sentence S to make it more coherent with C. \nC: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)

def format_test_prompt_llama3(context, sentence):
    return [
        {"role": "system", "content": """You are about to perform the task of coherence detection for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to output 1 if S is coherent with C based on the following instructions; otherwise, output 0. You should output 1 only if: \na) sentence S semantically connects to context C, and \nb) all entities discussed in the new sentence S have been introduced in C, and \nc) the relation between sentence S and previous ones in C makes sense due to a missing discourse marker, and \nd) the new sentence S does not contradict or is inconsistent with previously presented information in C, and \ne) the new sentence S introduces information that is relevant to the context C established by the writer. Now, please generate the answer:"""},
        {"role": "user", "content": """C: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)}
    ]
    # return """You are about to perform the task of coherence detection for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to output 1 if S is coherent with C based on the following instructions; otherwise, output 0. You should output 1 only if: \na) sentence S semantically connects to context C, and \nb) all entities discussed in the new sentence S have been introduced in C, and \nc) the relation between sentence S and previous ones in C makes sense due to a missing discourse marker, and \nd) the new sentence S does not contradict or is inconsistent with previously presented information in C, and \ne) the new sentence S introduces information that is relevant to the context C established by the writer. \nC: {context} \nS: {sentence} \nAnswer:""".format(context=context, sentence=sentence)

def format_test_prompt_rewriting_nr_llama3_instruct(context, sentence):
    return [
          {"role": "system", "content": """You are about to perform the task of sentence rewriting for the sentences written by second-language English learners. In this task, given a context C and a sentence S, where S is incoherent with C, you need to rewrite sentence S to make it coherent with C. Now, please generate:"""},
          {"role": "user", "content": """C: {context} \nS: {sentence} \n""".format(context=context, sentence=sentence)}]

def format_test_prompt_rewriting_r(context, sentence, reasons):
    r1, r2, r3, r4, r5, r6, r7 = reasons[0], reasons[1], reasons[2], reasons[3], reasons[4], reasons[5], reasons[6]
    reason_texts = ""
    if r1 == 1:
        reason_texts += "add reference words or repeated words/ideas or substitution that can semantically connect sentence S to context C. "
    if r2 == 1:
        reason_texts += "link the newly introduced entity or ambiguous entity in sentence S to context C. "
    if r3 == 1:
        reason_texts += "add or change a discourse marker that ties sentence S with context C. "
    if r4 == 1:
        reason_texts += "align the newly introduced information in sentence S with previously introduced information in context C so that the new information does not contradict the context. "
    if r5 == 1:
        reason_texts += "add information to sentence S that is relevant to the context C established by the writer. "
    if r6 == 1:
        reason_texts += "[DELETE]. "
    if r7 == 1:
        reason_texts += "rewrite sentence S so that the comment of sentence S agrees with the topic of the sentence itself. "


    return """You are about to perform the task of sentence rewriting for the sentences written by second-language English learners. In this task, given a sentence S and a context C, you need to rewrite sentence S to make it more coherent with C according to the following instructions: {reason_texts}  \nC: {context} \nS: {sentence} \nAnswer:""".format(reason_texts=reason_texts, context=context, sentence=sentence)

def format_test_prompt_rewriting_r_llama3_instruct(context, sentence, reasons):
    r1, r2, r3, r4, r5, r6, r7 = reasons[0], reasons[1], reasons[2], reasons[3], reasons[4], reasons[5], reasons[6]
    reason_texts = ""
    if r1 == 1:
        reason_texts += "add reference words or repeated words/ideas or substitution that can semantically connect sentence S to context C. "
    if r2 == 1:
        reason_texts += "link the newly introduced entity or ambiguous entity in sentence S to context C. "
    if r3 == 1:
        reason_texts += "add or change a discourse marker that ties sentence S with context C. "
    if r4 == 1:
        reason_texts += "align the newly introduced information in sentence S with previously introduced information in context C so that the new information does not contradict the context. "
    if r5 == 1:
        reason_texts += "add information to sentence S that is relevant to the context C established by the writer. "
    if r6 == 1:
        reason_texts += "[DELETE]. "
    if r7 == 1:
        reason_texts += "rewrite sentence S so that the comment of sentence S agrees with the topic of the sentence itself. "

    return [
          {"role": "system", "content": """You are about to perform the task of sentence rewriting for the sentences written by second-language English learners. In this task, given a context C and a sentence S, where S is incoherent with C, you need to rewrite sentence S to make it coherent with C according to the following instructions: {reason_texts}. Now, please generate:""".format(reason_texts=reason_texts)},
          {"role": "user", "content": """C: {context} \nS: {sentence} \n""".format(context=context, sentence=sentence)}]

def formulate_prompt_nr(context, sentence, output_1, output_2):
    return [
        {"role": "system", "content": """
            You are an English teacher aiming to improve coherence in student writing. You need to evaluate and select the best system based on the coherence of their outputs to a given instruction. This process will be used to create a leaderboard reflecting the most accurate and human-preferred answers."""},
        {"role": "user", "content": f"""
            I require a leaderboard for various systems. I'll provide you with prompts given to these models and their corresponding outputs. Your task is to assess these responses, and select the model that produces the most coherent output from a English teacher's perspective. \n\n## Instruction \n\n You are about to perform the task of sentence rewriting for the sentences written by second-language English learners. In this task, given a context C and a sentence S, where S is incoherent with C, you need to rewrite sentence S to make it coherent with C. The rewrite should be as minimal as possible. \nC: {context} \nS: {sentence} \nAnswer:\n\n## Model Outputs\n\nHere are the unordered outputs from the models. Each output is associated with a specific model, identified by a unique model identifier.\n\n
            ### model_identifier: "m" \n#### output: {output_1} \n\n### model_identifier: "M" \n#### output: {output_2} \n\n## Task \n\nEvaluate the models based on the coherence of their outputs to the given context C, and select the model that generated the most coherent output. The output from the model should rewrite the incoherent sentence S as minimally as possible. Retaining awkward phrasing or minor grammar errors from sentence S is acceptable as long as the output is coherent with context C. Answer by first providing a concise explanation and then end your answer by providing the model identifier of the most coherent output. We will use the last character of your output `output[-1]` as the name of the best model, so make sure you finish with the token of the model identifiers and nothing else: `m` or `M` (no quotes, no dots, no backticks, no new lines, ...). For example: \n\n### Concise explanation \n...some text... \n\n### Which is best, m or M? \n1\n\nNow is your turn. \n\n## Your answer: "Concise explanation" followed by "Which is best, m or M?"
        """,
        }
    ]


# def formulate_prompt_nr(context, sentence, output_1, output_2):
#     return [
#         {"role": "system", "content": """
#             You are a highly efficient assistant, who evaluates and selects the best large language model (LLMs) based on the quality of their responses to a given instruction. This process will be used to create a leaderboard reflecting the most accurate and human-preferred answers.
#     """},
#         {"role": "user", "content": f"""
#             I require a leaderboard for various large language models. I'll provide you with prompts given to these models and their corresponding outputs. Your task is to assess these responses, and select the model that produces the best output from a human perspective. \n\n## Instruction \n\n You are about to perform the task of sentence rewriting for the sentences written by second-language English learners. In this task, given a context C and a sentence S, where S is incoherent with C, you need to rewrite sentence S to make it coherent with C. The rewrite should be as minimal as possible. \nC: {context} \nS: {sentence} \nAnswer:\n\n## Model Outputs\n\nHere are the unordered outputs from the models. Each output is associated with a specific model, identified by a unique model identifier.\n\n
#             ### model_identifier: "m" \n#### output: {output_1} \n\n### model_identifier: "M" \n#### output: {output_2} \n\n## Task \n\nEvaluate the models based on the coherence of their outputs to the given context C, and select the model that generated the best output. Answer by first providing a concise explanation and then end your answer by providing the model identifier of the best output. We will use the last character of your output `output[-1]` as the name of the best model, so make sure you finish with the token of the model identifiers and nothing else: `m` or `M` (no quotes, no dots, no backticks, no new lines, ...). For example: \n\n### Concise explanation \n...some text... \n\n### Which is best, m or M? \nM\n\nNow is your turn. \n\n## Your answer: "Concise explanation" followed by "Which is best, m or M?"
#         """,
#         }
#     ]

def formulate_prompt_r(context, sentence, reasons, output_1, output_2):
    r1, r2, r3, r4, r5, r6, r7 = reasons[0], reasons[1], reasons[2], reasons[3], reasons[4], reasons[5], reasons[6]

    reason_texts = ""
    if r1 == 1:
        reason_texts += "add reference words or repeated words/ideas or substitution that can semantically connect sentence S to context C. "
    if r2 == 1:
        reason_texts += "link the newly introduced entity or ambiguous entity in sentence S to context C. "
    if r3 == 1:
        reason_texts += "add or change a discourse marker that ties sentence S with context C. "
    if r4 == 1:
        reason_texts += "align the newly introduced information in sentence S with previously introduced information in context C so that the new information does not contradict the context. "
    if r5 == 1:
        reason_texts += "add information to sentence S that is relevant to the context C established by the writer. "
    if r6 == 1:
        reason_texts += "[DELETE] "
    if r7 == 1:
        reason_texts += "rewrite sentence S so that the comment of sentence S agrees with the topic of the sentence itself. "


    return [
        {"role": "system", "content": """
            You are an English teacher aiming to improve coherence in student writing. You need to evaluate and select the best system based on the coherence of their outputs to a given instruction. This process will be used to create a leaderboard reflecting the most accurate and human-preferred answers.
    """},
        {"role": "user", "content": f"""
            I require a leaderboard for various systems. I'll provide you with prompts given to these models and their corresponding outputs. Your task is to assess these responses, and select the model that produces the most coherent output from a English teacher's perspective. \n\n## Instruction \n\n You are about to perform the task of sentence rewriting for the sentences written by second-language English learners. In this task, given a context C and a sentence S, where S is incoherent with C, you need to rewrite sentence S to make it coherent with C according to the following instructions: The rewrite should be as minimal as possible. {reason_texts}. \nC: {context} \nS: {sentence} \nAnswer:\n\n## Model Outputs\n\nHere are the unordered outputs from the models. Each output is associated with a specific model, identified by a unique model identifier.\n\n
            ### model_identifier: "m" \n#### output: {output_1} \n\n### model_identifier: "M" \n#### output: {output_2} \n\n## Task \n\nEvaluate the models based on the coherence of their outputs to the given context C, and select the model that generated the most coherent output. The output from the model should rewrite the incoherent sentence S as minimally as possible. Retaining awkward phrasing or minor grammar errors from sentence S is acceptable as long as the output is coherent with context C. Answer by first providing a concise explanation and then end your answer by providing the model identifier of the most coherent output. We will use the last character of your output `output[-1]` as the name of the best model, so make sure you finish with the token of the model identifiers and nothing else: `m` or `M` (no quotes, no dots, no backticks, no new lines, ...). For example: \n\n### Concise explanation \n...some text... \n\n### Which is best, m or M? \n1\n\nNow is your turn. \n\n## Your answer: "Concise explanation" followed by "Which is best, m or M?"
        """,
        }
    ]

# def formulate_prompt_r(context, sentence, reasons, output_1, output_2):
#     r1, r2, r3, r4, r5, r6, r7 = reasons[0], reasons[1], reasons[2], reasons[3], reasons[4], reasons[5], reasons[6]

#     reason_texts = ""
#     if r1 == 1:
#         reason_texts += "add reference words or repeated words/ideas or substitution that can semantically connect sentence S to context C. "
#     if r2 == 1:
#         reason_texts += "link the newly introduced entity or ambiguous entity in sentence S to context C. "
#     if r3 == 1:
#         reason_texts += "add or change a discourse marker that ties sentence S with context C. "
#     if r4 == 1:
#         reason_texts += "align the newly introduced information in sentence S with previously introduced information in context C so that the new information does not contradict the context. "
#     if r5 == 1:
#         reason_texts += "add information to sentence S that is relevant to the context C established by the writer. "
#     if r6 == 1:
#         reason_texts += "[DELETE] "
#     if r7 == 1:
#         reason_texts += "rewrite sentence S so that the comment of sentence S agrees with the topic of the sentence itself. "


#     return [
#         {"role": "system", "content": """
#             You are a highly efficient assistant, who evaluates and selects the best large language model (LLMs) based on the quality of their responses to a given instruction. This process will be used to create a leaderboard reflecting the most accurate and human-preferred answers.
#     """},
#         {"role": "user", "content": f"""
#             I require a leaderboard for various large language models. I'll provide you with prompts given to these models and their corresponding outputs. Your task is to assess these responses, and select the model that produces the best output from a human perspective. \n\n## Instruction \n\n You are about to perform the task of sentence rewriting for the sentences written by second-language English learners. In this task, given a context C and a sentence S, where S is incoherent with C, you need to rewrite sentence S to make it coherent with C according to the following instructions: The rewrite should be as minimal as possible. {reason_texts}. \nC: {context} \nS: {sentence} \nAnswer:\n\n## Model Outputs\n\nHere are the unordered outputs from the models. Each output is associated with a specific model, identified by a unique model identifier.\n\n
#             ### model_identifier: "m" \n#### output: {output_1} \n\n### model_identifier: "M" \n#### output: {output_2} \n\n## Task \n\nEvaluate the models based on the coherence of their outputs to the given context C, and select the model that generated the best output. Answer by first providing a concise explanation and then end your answer by providing the model identifier of the best output. We will use the last character of your output `output[-1]` as the name of the best model, so make sure you finish with the token of the model identifiers and nothing else: `m` or `M` (no quotes, no dots, no backticks, no new lines, ...). For example: \n\n### Concise explanation \n...some text... \n\n### Which is best, m or M? \n1\n\nNow is your turn. \n\n## Your answer: "Concise explanation" followed by "Which is best, m or M?"
#         """,
#         }
#     ]